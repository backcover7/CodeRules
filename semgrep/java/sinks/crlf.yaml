rules:
  - id: crlf
    options:
      symbolic_propagation: true
    pattern-either:
      - pattern: (javax.servlet.http.HttpServletResponse $RESP).addCookie(...)
      - pattern: (javax.servlet.http.HttpServletResponse $RESP).addHeader(...)
      - pattern: (javax.servlet.http.HttpServletResponse $RESP).setHeader(...)
      - pattern: (jakarta.servlet.http.HttpServletResponse $RESP).addCookie(...)
      - pattern: (jakarta.servlet.http.HttpServletResponse $RESP).addHeader(...)
      - pattern: (jakarta.servlet.http.HttpServletResponse $RESP).setHeader(...)
      - pattern: (javax.ws.rs.core.Response.ResponseBuilder $RESP).header(...)
      - pattern: (org.springframework.http.server.ServerHttpResponse $RESP).getHeaders().add(...)
      - pattern: (org.springframework.http.HttpHeaders $HEADER).set(...)
      - pattern: (org.springframework.web.server.ServerWebExchange $HEADER).getResponse().getHeaders().add(...)
      - pattern: org.springframework.http.ResponseEntity. ... .header(...)
    message: Semgrep found a match related to CRLF injection
    severity: WARNING
    languages:
      - java
rules:
  - id: ${node} 
    options:
      symbolic_propagation: true
    pattern-either:
      - pattern: (javax.servlet.jsp.JspWriter $A).write(...)
      - pattern: (javax.servlet.jsp.JspWriter $A).append(...)
      - pattern-either:
        - pattern: (javax.servlet.jsp.JspWriter $A).print(...)
        - pattern: javax.servlet.jsp.JspFactory.getDefaultFactory(...). ... .print(...)
        - pattern: (javax.faces.webapp.UIComponentClassicTagBase $A).getBodyContent(...). ... .print(...)
        - pattern: (freemarker.ext.jsp.FreeMarkerPageContext $A).popBody(...). ... .print(...)
        - pattern: (org.apache.struts.mock.MockPageContext $A).pushBody(...). ... .print(...)
        - pattern: javax.faces.webapp.UIComponentClassicTagBase.getParentUIComponentClassicTagBase(...). ... .print(...)
        - pattern: (freemarker.ext.jsp.FreeMarkerPageContext $A).getOut(...). ... .print(...)
        - pattern: (javax.servlet.jsp.PageContext $A).pushBody(...). ... .print(...)
        - pattern: (javax.servlet.jsp.tagext.BodyTagSupport $A).getBodyContent(...). ... .print(...)
        - pattern: (org.apache.struts.mock.MockPageContext $A).popBody(...). ... .print(...)
        - pattern: (javax.servlet.jsp.tagext.BodyTagSupport $A).getPreviousOut(...). ... .print(...)
        - pattern: (freemarker.ext.jsp.FreeMarkerPageContext $A).pushBody(...). ... .print(...)
        - pattern: org.apache.struts2.ServletActionContext.getPageContext(...). ... .print(...)
        - pattern: (freemarker.ext.jsp.FreeMarkerJspFactory $A).getPageContext(...). ... .print(...)
        - pattern: (freemarker.ext.jsp.SimpleTagDirectiveModel.1 $A).getJspContext(...). ... .print(...)
        - pattern: (javax.servlet.jsp.tagext.BodyContent $A).getEnclosingWriter(...). ... .print(...)
        - pattern: (javax.servlet.jsp.tagext.JspFragment $A).getJspContext(...). ... .print(...)
        - pattern: (javax.servlet.jsp.JspContext $A).pushBody(...). ... .print(...)
        - pattern: (javax.faces.webapp.UIComponentClassicTagBase $A).getPreviousOut(...). ... .print(...)
        - pattern: (javax.servlet.jsp.JspFactory $A).getPageContext(...). ... .print(...)
        - pattern: (javax.servlet.jsp.JspContext $A).getOut(...). ... .print(...)
        - pattern: (org.apache.struts.mock.MockPageContext $A).getOut(...). ... .print(...)
        - pattern: (javax.servlet.jsp.JspContext $A).popBody(...). ... .print(...)
      - pattern-either:
        - pattern: org.apache.struts2.ServletActionContext.getPageContext(...). ... .println(...)
        - pattern: (javax.servlet.jsp.JspContext $A).pushBody(...). ... .println(...)
        - pattern: (javax.servlet.jsp.tagext.BodyTagSupport $A).getPreviousOut(...). ... .println(...)
        - pattern: (freemarker.ext.jsp.FreeMarkerPageContext $A).pushBody(...). ... .println(...)
        - pattern: (javax.servlet.jsp.JspContext $A).popBody(...). ... .println(...)
        - pattern: (javax.faces.webapp.UIComponentClassicTagBase $A).getBodyContent(...). ... .println(...)
        - pattern: (javax.servlet.jsp.tagext.BodyContent $A).getEnclosingWriter(...). ... .println(...)
        - pattern: (freemarker.ext.jsp.SimpleTagDirectiveModel.1 $A).getJspContext(...). ... .println(...)
        - pattern: (javax.servlet.jsp.JspContext $A).getOut(...). ... .println(...)
        - pattern: javax.servlet.jsp.JspFactory.getDefaultFactory(...). ... .println(...)
        - pattern: (javax.servlet.jsp.JspFactory $A).getPageContext(...). ... .println(...)
        - pattern: (org.apache.struts.mock.MockPageContext $A).getOut(...). ... .println(...)
        - pattern: (javax.faces.webapp.UIComponentClassicTagBase $A).getPreviousOut(...). ... .println(...)
        - pattern: (org.apache.struts.mock.MockPageContext $A).pushBody(...). ... .println(...)
        - pattern: (javax.servlet.jsp.PageContext $A).pushBody(...). ... .println(...)
        - pattern: javax.faces.webapp.UIComponentClassicTagBase.getParentUIComponentClassicTagBase(...). ... .println(...)
        - pattern: (javax.servlet.jsp.tagext.JspFragment $A).getJspContext(...). ... .println(...)
        - pattern: (javax.servlet.jsp.JspWriter $A).println(...)
        - pattern: (freemarker.ext.jsp.FreeMarkerPageContext $A).getOut(...). ... .println(...)
        - pattern: (freemarker.ext.jsp.FreeMarkerJspFactory $A).getPageContext(...). ... .println(...)
        - pattern: (javax.servlet.jsp.tagext.BodyTagSupport $A).getBodyContent(...). ... .println(...)
        - pattern: (freemarker.ext.jsp.FreeMarkerPageContext $A).popBody(...). ... .println(...)
        - pattern: (org.apache.struts.mock.MockPageContext $A).popBody(...). ... .println(...)
      - pattern: (org.owasp.encoder.tag.ForHtmlTag $A).doTag(...)
    message: Semgrep found a match of method in ${node} csv
    languages: [java]
    severity: WARNING
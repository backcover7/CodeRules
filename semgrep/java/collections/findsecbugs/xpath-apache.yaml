rules:
  - id: ${node} 
    options:
      symbolic_propagation: true
    pattern-either:
      - pattern: org.apache.xpath.XPathAPI.eval(...)
      - pattern: org.apache.xpath.XPathAPI.selectNodeIterator(...)
      - pattern: org.apache.xpath.XPathAPI.selectNodeList(...)
      - pattern: org.apache.xpath.XPathAPI.selectSingleNode(...)
      - pattern: com.sun.org.apache.xpath.internal.XPathAPI.eval(...)
      - pattern: com.sun.org.apache.xpath.internal.XPathAPI.selectNodeIterator(...)
      - pattern: com.sun.org.apache.xpath.internal.XPathAPI.selectNodeList(...)
      - pattern: com.sun.org.apache.xpath.internal.XPathAPI.selectSingleNode(...)
      - pattern-either:
        - pattern: (org.apache.xml.security.utils.JDKXPathFactory $A).newXPathAPI(...). ... .evaluate(...)
        - pattern: (org.apache.xml.security.utils.XPathFactory $A).newXPathAPI(...). ... .evaluate(...)
        - pattern: org.apache.xml.security.utils.XPathFactory.newInstance(...). ... .evaluate(...)
        - pattern: (org.apache.xml.security.utils.XPathAPI $A).evaluate(...)
        - pattern: (org.apache.xml.security.utils.XalanXPathFactory $A).newXPathAPI(...). ... .evaluate(...)
      - pattern-either:
        - pattern: (org.apache.xml.security.utils.XPathFactory $A).newXPathAPI(...). ... .selectNodeList(...)
        - pattern: (org.apache.xml.security.utils.XPathAPI $A).selectNodeList(...)
        - pattern: org.apache.xml.security.utils.XPathFactory.newInstance(...). ... .selectNodeList(...)
        - pattern: (org.apache.xml.security.utils.JDKXPathFactory $A).newXPathAPI(...). ... .selectNodeList(...)
        - pattern: (org.apache.xml.security.utils.XalanXPathFactory $A).newXPathAPI(...). ... .selectNodeList(...)
      - pattern: (org.apache.xml.security.utils.JDKXPathAPI $A).evaluate(...)
      - pattern: (org.apache.xml.security.utils.JDKXPathAPI $A).selectNodeList(...)
      - pattern: (org.apache.xml.security.utils.XalanXPathAPI $A).evaluate(...)
      - pattern: (org.apache.xml.security.utils.XalanXPathAPI $A).selectNodeList(...)
    message: Semgrep found a match of method in ${node} csv
    languages: [java]
    severity: WARNING
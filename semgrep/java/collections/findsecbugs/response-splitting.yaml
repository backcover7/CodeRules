rules:
  - id: ${node} 
    options:
      symbolic_propagation: true
    pattern-either:
      - pattern-either:
        - pattern: new javax.servlet.http.Cookie(...)
      - pattern-either:
        - pattern: (org.springframework.security.web.jackson2.CookieDeserializer $A).deserialize(...). ... .setValue(...)
        - pattern: (org.springframework.security.web.savedrequest.SavedCookie $A).getCookie(...). ... .setValue(...)
        - pattern: org.apache.catalina.core.ApplicationSessionCookieConfig.createSessionCookie(...). ... .setValue(...)
        - pattern: org.springframework.web.util.WebUtils.getCookie(...). ... .setValue(...)
        - pattern: (javax.servlet.http.Cookie $A).setValue(...)
      - pattern-either:
        - pattern: (org.springframework.security.web.context.HttpRequestResponseHolder $A).getResponse(...). ... .addHeader(...)
        - pattern: org.apache.shiro.web.util.WebUtils.toHttp(...). ... .addHeader(...)
        - pattern: (org.apache.turbine.services.rundata.RunDataService $A).getRunData(...). ... .addHeader(...)
        - pattern: (org.apache.catalina.connector.Response $A).getRequest(...). ... .addHeader(...)
        - pattern: org.apache.turbine.util.RunDataFactory.getRunData(...). ... .addHeader(...)
        - pattern: (org.thymeleaf.context.WebExpressionContext $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.apache.struts2.components.ComponentUrlProvider $A).getHttpServletResponse(...). ... .addHeader(...)
        - pattern: (org.apache.struts2.components.Anchor $A).getUrlProvider(...). ... .addHeader(...)
        - pattern: (org.apache.turbine.services.rundata.DefaultTurbineRunData $A).getResponse(...). ... .addHeader(...)
        - pattern: (freemarker.ext.servlet.HttpRequestHashModel $A).getResponse(...). ... .addHeader(...)
        - pattern: org.apache.struts2.ServletActionContext.getResponse(...). ... .addHeader(...)
        - pattern: (org.apache.catalina.connector.Request $A).getResponse(...). ... .addHeader(...)
        - pattern: org.springframework.web.filter.RelativeRedirectResponseWrapper.wrapIfNecessary(...). ... .addHeader(...)
        - pattern: (org.apache.struts2.components.UrlProvider $A).getHttpServletResponse(...). ... .addHeader(...)
        - pattern: (org.springframework.security.web.firewall.HttpFirewall $A).getFirewalledResponse(...). ... .addHeader(...)
        - pattern: (org.springframework.web.context.request.ServletRequestAttributes $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.thymeleaf.context.IWebContext $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.apache.turbine.services.rundata.DefaultTurbineRunData $A).getCookies(...). ... .addHeader(...)
        - pattern: (org.springframework.security.web.firewall.DefaultHttpFirewall $A).getFirewalledResponse(...). ... .addHeader(...)
        - pattern: org.apache.shiro.web.util.WebUtils.getHttpResponse(...). ... .addHeader(...)
        - pattern: (org.apache.catalina.connector.Connector $A).createRequest(...). ... .addHeader(...)
        - pattern: (org.apache.turbine.util.CookieParser $A).getRunData(...). ... .addHeader(...)
        - pattern: (org.apache.catalina.connector.Request $A).getConnector(...). ... .addHeader(...)
        - pattern: (org.thymeleaf.context.WebEngineContext $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.springframework.http.server.ServletServerHttpResponse $A).getServletResponse(...). ... .addHeader(...)
        - pattern: (org.apache.turbine.util.RunData $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.apache.struts2.components.URL $A).getUrlProvider(...). ... .addHeader(...)
        - pattern: (org.apache.turbine.util.RunData $A).getCookies(...). ... .addHeader(...)
        - pattern: (org.apache.struts.chain.contexts.ServletActionContext $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.apache.commons.chain.web.servlet.ServletWebContext $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.springframework.security.web.FilterInvocation $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.springframework.security.web.session.SessionInformationExpiredEvent $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.apache.catalina.startup.Tomcat $A).getConnector(...). ... .addHeader(...)
        - pattern: (org.apache.turbine.services.rundata.TurbineRunData $A).getCookieParser(...). ... .addHeader(...)
        - pattern: (org.apache.catalina.connector.Connector $A).createResponse(...). ... .addHeader(...)
        - pattern: (org.springframework.boot.web.embedded.tomcat.TomcatWebServer $A).getTomcat(...). ... .addHeader(...)
        - pattern: (org.apache.turbine.services.rundata.TurbineRunDataService $A).getRunData(...). ... .addHeader(...)
        - pattern: (org.thymeleaf.context.WebContext $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.apache.catalina.connector.Response $A).getResponse(...). ... .addHeader(...)
        - pattern: (org.springframework.security.web.firewall.StrictHttpFirewall $A).getFirewalledResponse(...). ... .addHeader(...)
        - pattern: (org.springframework.security.web.FilterInvocation $A).getHttpResponse(...). ... .addHeader(...)
        - pattern: (javax.servlet.http.HttpServletResponse $A).addHeader(...)
        - pattern: (org.apache.turbine.services.rundata.DefaultTurbineRunData $A).getCookieParser(...). ... .addHeader(...)
        - pattern: (org.apache.turbine.util.parser.DefaultCookieParser $A).getRunData(...). ... .addHeader(...)
      - pattern-either:
        - pattern: (org.apache.turbine.util.parser.DefaultCookieParser $A).getRunData(...). ... .setHeader(...)
        - pattern: (org.apache.struts.chain.contexts.ServletActionContext $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.turbine.util.CookieParser $A).getRunData(...). ... .setHeader(...)
        - pattern: (org.apache.struts2.components.UrlProvider $A).getHttpServletResponse(...). ... .setHeader(...)
        - pattern: (org.apache.turbine.services.rundata.TurbineRunData $A).getCookieParser(...). ... .setHeader(...)
        - pattern: (org.thymeleaf.context.IWebContext $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.thymeleaf.context.WebEngineContext $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.struts2.components.Anchor $A).getUrlProvider(...). ... .setHeader(...)
        - pattern: (org.springframework.boot.web.embedded.tomcat.TomcatWebServer $A).getTomcat(...). ... .setHeader(...)
        - pattern: (org.springframework.http.server.ServletServerHttpResponse $A).getServletResponse(...). ... .setHeader(...)
        - pattern: (org.apache.turbine.services.rundata.RunDataService $A).getRunData(...). ... .setHeader(...)
        - pattern: (org.springframework.security.web.FilterInvocation $A).getHttpResponse(...). ... .setHeader(...)
        - pattern: org.apache.struts2.ServletActionContext.getResponse(...). ... .setHeader(...)
        - pattern: (org.thymeleaf.context.WebContext $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.catalina.connector.Connector $A).createResponse(...). ... .setHeader(...)
        - pattern: (org.apache.catalina.startup.Tomcat $A).getConnector(...). ... .setHeader(...)
        - pattern: (org.springframework.security.web.FilterInvocation $A).getResponse(...). ... .setHeader(...)
        - pattern: org.apache.shiro.web.util.WebUtils.getHttpResponse(...). ... .setHeader(...)
        - pattern: (org.apache.struts2.components.ComponentUrlProvider $A).getHttpServletResponse(...). ... .setHeader(...)
        - pattern: (org.springframework.security.web.firewall.HttpFirewall $A).getFirewalledResponse(...). ... .setHeader(...)
        - pattern: org.springframework.web.filter.RelativeRedirectResponseWrapper.wrapIfNecessary(...). ... .setHeader(...)
        - pattern: (org.thymeleaf.context.WebExpressionContext $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.turbine.services.rundata.DefaultTurbineRunData $A).getCookies(...). ... .setHeader(...)
        - pattern: (org.apache.turbine.services.rundata.DefaultTurbineRunData $A).getCookieParser(...). ... .setHeader(...)
        - pattern: (org.apache.catalina.connector.Response $A).getRequest(...). ... .setHeader(...)
        - pattern: (org.apache.catalina.connector.Response $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.catalina.connector.Request $A).getConnector(...). ... .setHeader(...)
        - pattern: (org.springframework.security.web.firewall.StrictHttpFirewall $A).getFirewalledResponse(...). ... .setHeader(...)
        - pattern: (javax.servlet.http.HttpServletResponse $A).setHeader(...)
        - pattern: (org.springframework.security.web.context.HttpRequestResponseHolder $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.commons.chain.web.servlet.ServletWebContext $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.springframework.security.web.firewall.DefaultHttpFirewall $A).getFirewalledResponse(...). ... .setHeader(...)
        - pattern: org.apache.turbine.util.RunDataFactory.getRunData(...). ... .setHeader(...)
        - pattern: (org.apache.turbine.services.rundata.TurbineRunDataService $A).getRunData(...). ... .setHeader(...)
        - pattern: (org.apache.struts2.components.URL $A).getUrlProvider(...). ... .setHeader(...)
        - pattern: (org.apache.turbine.services.rundata.DefaultTurbineRunData $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.catalina.connector.Connector $A).createRequest(...). ... .setHeader(...)
        - pattern: org.apache.shiro.web.util.WebUtils.toHttp(...). ... .setHeader(...)
        - pattern: (org.springframework.security.web.session.SessionInformationExpiredEvent $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.catalina.connector.Request $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.springframework.web.context.request.ServletRequestAttributes $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.turbine.util.RunData $A).getCookies(...). ... .setHeader(...)
        - pattern: (freemarker.ext.servlet.HttpRequestHashModel $A).getResponse(...). ... .setHeader(...)
        - pattern: (org.apache.turbine.util.RunData $A).getResponse(...). ... .setHeader(...)
      - pattern: (javax.servlet.http.HttpServletResponseWrapper $A).addHeader(...)
      - pattern: (javax.servlet.http.HttpServletResponseWrapper $A).setHeader(...)
    message: Semgrep found a match of method in ${node} csv
    languages: [java]
    severity: WARNING
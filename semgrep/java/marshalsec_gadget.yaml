rules:
  - id: marshalsec_gadget
    options:
      symbolic_propagation: true
    # cases/marshalsec_gadget
    mode: join
    join:
      refs:
      - rule: sources/setter_and_constructor.yaml
        as: setter_and_constructor
      - rule: sinks/jndi.yaml
        as: jndi_sink
      - rule: pseudo_callgraph_java.yaml
        as: callgraph
      on:
      - 'callgraph.$CALLER --> callgraph.$CALLEE'
      - 'setter_and_constructor.$METHOD == callgraph.$CALLER'
      - 'callgraph.$CALLEE == jndi_sink.$METHOD'
    message: gagdget
    severity: ERROR
rules:
  - id: dos
    options:
      symbolic_propagation: true
    pattern-either:
      - patterns:
        - pattern-either:
          - pattern: while($COND) {...}
          - pattern: do {...} while($COND);
          - pattern: for($INIT;$COND;$BOUNDARY) {...}
        - focus-metavariable: $COND
      - patterns:
        - pattern: new $ARRAY[$SIZE]
        - focus-metavariable: $COND
    message: Semgrep found a DoS pattern
    languages:
      - java
    severity: WARNING
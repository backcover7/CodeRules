rules:
  - id: java_lang
    patterns:
      - pattern-either:
        - pattern: $JAVA.$LANG.$X
        - pattern: ($JAVA.$LANG.$X $OBJ)
      - metavariable-regex:
          metavariable: $JAVA
          regex: ^java$
      - metavariable-regex:
          metavariable: $LANG
          regex: ^lang$
      - metavariable-regex:
          metavariable: $X
          regex: ^(AbstractMethodError|Appendable|ArithmeticException|ArrayIndexOutOfBoundsException|ArrayStoreException|AssertionError|AutoCloseable|Boolean|BootstrapMethodError|Byte|CharSequence|Character|Class|ClassCastException|ClassCircularityError|ClassFormatError|ClassLoader|ClassNotFoundException|ClassValue|CloneNotSupportedException|Cloneable|Comparable|Compiler|Deprecated|Double|Enum|EnumConstantNotPresentException|Error|Exception|ExceptionInInitializerError|Float|FunctionalInterface|IllegalAccessError|IllegalAccessException|IllegalArgumentException|IllegalMonitorStateException|IllegalStateException|IllegalThreadStateException|IncompatibleClassChangeError|IndexOutOfBoundsException|InheritableThreadLocal|InstantiationError|InstantiationException|Integer|InternalError|InterruptedException|Iterable|LinkageError|Long|Math|NegativeArraySizeException|NoClassDefFoundError|NoSuchFieldError|NoSuchFieldException|NoSuchMethodError|NoSuchMethodException|NullPointerException|Number|NumberFormatException|Object|OutOfMemoryError|Override|Package|Process|ProcessBuilder|Readable|ReflectiveOperationException|Runnable|Runtime|RuntimeException|RuntimePermission|SafeVarargs|SecurityException|SecurityManager|Short|StackOverflowError|StackTraceElement|StrictMath|String|StringBuffer|StringBuilder|StringIndexOutOfBoundsException|SuppressWarnings|System|Thread|ThreadDeath|ThreadGroup|ThreadLocal|Throwable|TypeNotPresentException|UnknownError|UnsatisfiedLinkError|UnsupportedClassVersionError|UnsupportedOperationException|VerifyError|VirtualMachineError|Void)$
    fix-regex:
      regex: java\.lang\.(.*)
      replacement: \1
    message: Semgrep found a match of java.lang in static call which could be removed.
    languages:
      - java
    severity: WARNING